import type { EmptyFoodEntry as PartialFoodEntry, Food } from '@utils/db';
const sampleFoodEntries: Food[] = [{ "brand": "Taifun", "calories": 1.9024856, "carbs": 0.02, "category": "Pflanzliche Lebensmittel und Getränke, Pflanzliche Lebensmittel, Hülsenfrüchte und Hülsenfruchtprodukte, en:Meat alternatives, Tofu", "fat": 0.13, "id": 4895065, "name": "Pizza-Pizza Bratfilets", "protein": 0.16, "serving_size_g": 160, "serving_text": "g", "upc": "4012359144201" }, { "brand": "Rocky's Pizza", "calories": 2.7700765, "carbs": 0.25, "category": null, "fat": 0.14, "id": 5529501, "name": "Rocky‘s Pizza Viel Pizza", "protein": 0.12, "serving_size_g": 430, "serving_text": "g", "upc": "4002084121998" }, { "brand": null, "calories": 4.000956, "carbs": 0.6333, "category": "Snacks, Sweet snacks, Biscuits and cakes", "fat": 0.1, "id": 5627252, "name": "Pizza crackers, pizza", "protein": 0.1, "serving_size_g": 100, "serving_text": "g", "upc": "0711381335208" }, { "brand": "Goya", "calories": 2.3900573, "carbs": 0.352, "category": null, "fat": 0.0563, "id": 5563050, "name": "Pizza Empanadas, Pizza", "protein": 0.0986, "serving_size_g": 283.49524, "serving_text": "oz", "upc": "0041331090308" }, { "brand": "Amnon's Pizza", "calories": 2.3398662, "carbs": 0.3247, "category": "Meals, Pizzas pies and quiches, Pizzas", "fat": 0.0649, "id": 5962928, "name": "Amnon's pizza, large pizza slices", "protein": 0.1169, "serving_size_g": 100, "serving_text": "g", "upc": "0652160013552" }, { "brand": "Mystic Pizza Llc", "calories": 2.210803, "carbs": 0.2468, "category": "Meals, Pizzas pies and quiches, Pizzas", "fat": 0.0909, "id": 5223948, "name": "Mystic Pizza, Ultimate Pepperoni Pizza", "protein": 0.0714, "serving_size_g": 100, "serving_text": "g", "upc": "0795404132029" }, { "brand": "Pizza casei", "calories": 3.2719886, "carbs": 0.54, "category": "Aluat proaspat", "fat": 0.089, "id": 5622879, "name": "Pizza casei Blat de pizza", "protein": 0.065, "serving_size_g": 230, "serving_text": "g", "upc": "5949040201792" }, { "brand": null, "calories": 3.209847, "carbs": 0, "category": "Dairies, Fermented foods, Fermented milk products, Cheeses", "fat": 0.25, "id": 5012570, "name": "Shredded pizza cheese, pizza", "protein": 0.2857, "serving_size_g": 100, "serving_text": "g", "upc": "0078812369455" }, { "brand": null, "calories": 2.2203634, "carbs": 0.2741, "category": null, "fat": 0.0815, "id": 5287781, "name": "Flatbread pizza pizza wrap", "protein": 0.0741, "serving_size_g": 100, "serving_text": "g", "upc": "0892453001150" }, { "brand": "Chelsea Milling Company", "calories": 3.7810707, "carbs": 0.7027, "category": "Snacks, Sweet snacks, Biscuits and cakes, Cakes, Cooking helpers, Pastry helpers, Baking Mixes, Dessert mixes, Cake mixes", "fat": 0.0676, "id": 6135299, "name": "Pizza crust mix, pizza", "protein": 0.0811, "serving_size_g": 100, "serving_text": "g", "upc": "0072486001307" }, { "brand": null, "calories": 1.6802104, "carbs": 0.2832, "category": "Frozen foods, Sandwiches", "fat": 0.0354, "id": 5086070, "name": "Microwaveable pizza burrito, pizza", "protein": 0.0531, "serving_size_g": 100, "serving_text": "g", "upc": "0079606011758" }, { "brand": "Riggano", "calories": 2.4091778, "carbs": 0.278, "category": "Tiefkühlprodukte, Fertiggerichte, Pizzas - Kuchen und Quiches, Pizzen, Gefrorene Pizzas und Quiches, Tiefkühlpizza", "fat": 0.095, "id": 6051129, "name": "Pizza Prosciutto / Pizza Tonno", "protein": 0.1, "serving_size_g": 660, "serving_text": "g", "upc": "12154172" }, { "brand": "Antico Molino Pussini", "calories": 3.7691205, "carbs": 0.7, "category": "Cibi e bevande a base vegetale, Cibi a base vegetale, Cereali e patate, Cereali e i loro prodotti, Farine, Farine di cereali", "fat": 0.052, "id": 5039633, "name": "Pizza Bontà preparato per pizza", "protein": 0.1, "serving_size_g": 1000, "serving_text": "kg", "upc": "8009831000328" }, { "brand": null, "calories": 2.459369, "carbs": 0.4035, "category": "Plant-based foods and beverages, Plant-based foods, Cereals and potatoes, Breads", "fat": 0.0526, "id": 5129973, "name": "Pizza crusts + pizza sauce", "protein": 0.0877, "serving_size_g": 100, "serving_text": "g", "upc": "0064170020398" }, { "brand": "Totino's", "calories": 2.4713192, "carbs": 0.3647, "category": "Plant-based foods and beverages, Plant-based foods, Cereals and potatoes, Breads", "fat": 0.0941, "id": 5247197, "name": "Pizza rolls pizza rolls snacks", "protein": 0.0588, "serving_size_g": 100, "serving_text": "g", "upc": "0042800005809" }, { "brand": null, "calories": 0.7289675, "carbs": 0.129, "category": "Condiments, Sauces, Groceries", "fat": 0.0161, "id": 5247915, "name": "Chunky pizza sauce, chunky pizza", "protein": 0.0161, "serving_size_g": 100, "serving_text": "g", "upc": "0007789027832" }, { "brand": null, "calories": 2.244264, "carbs": 0.2993197, "category": null, "fat": 0.08163265, "id": 6019184, "name": "Wood-Fired Crust Pizza Margherita Pizza", "protein": 0.0952381, "serving_size_g": 100, "serving_text": "g", "upc": "0085239098318" }, { "brand": null, "calories": 2.5191205, "carbs": 0.3037, "category": null, "fat": 0.0963, "id": 5921273, "name": "Fiesta flatbread pizza, pizza wrap", "protein": 0.1111, "serving_size_g": 100, "serving_text": "g", "upc": "0892453001181" }, { "brand": "Manosque", "calories": 2.5693116, "carbs": 0.198, "category": "Surgelés, Plats préparés, Pizzas tartes salées et quiches, Pizzas, Pizzas et tartes surgelées, Pizzas surgelées", "fat": 0.134, "id": 5842709, "name": "Pizza de manosque, Pizza au chevre", "protein": 0.134, "serving_size_g": 430, "serving_text": "g", "upc": "3498424203454" }, { "brand": null, "calories": 2.4498088, "carbs": 0.344, "category": "Plats préparés, Pizzas tartes salées et quiches, Pizzas", "fat": 0.083, "id": 5927922, "name": "Pizza fraîche verse pizza gluten free", "protein": 0.065, "serving_size_g": 100, "serving_text": "g", "upc": "5413883005768" }]
import Constants from "expo-constants";
export async function fetchSearchResults(query: string) {
    // in development mode, return sample data
    // if (Constants.executionEnvironment == 'storeClient') {
    //     await new Promise(resolve => setTimeout(resolve, 500));
    //     return normalizedEntries(sampleFoodEntries);
    // }
    const response = await fetch(`${process.env.EXPO_PUBLIC_API_URL}?q=${encodeURIComponent(query)}`);
    if (response.ok) {
        const data = await response.json() as Food[];

        return normalizedEntries(data);
    } else {
        throw new Error('Error fetching search results');
    }
}


function normalizedEntries(entries: Food[]) {
    return entries.map(({ id, ...rest }) => (
        { ...rest, food_id: id }
    )) as PartialFoodEntry[];
}